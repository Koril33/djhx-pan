<!-- share_view.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>分享内容</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/file.css') }}">
</head>
<body>
<div class="fileContainer">
    <h1>分享内容</h1>

    {% if is_dir_view and breadcrumbs %}
    <div class="breadcrumbs">
        <a href="{{ url_for('file.view_share', share_key=share.share_key) }}">根目录</a>
        {% for crumb in breadcrumbs %}
            <span> / </span>
            <span>{{ crumb.filename }}</span>
        {% endfor %}
    </div>
    {% endif %}

    {% if files %}
        <div class="file-header">
            <div></div>
            <div>文件名</div>
            <div>大小</div>
            <div>修改时间</div>
            <div>操作</div>
        </div>
        {% for f in files %}
            <div class="file-item-wrapper">
                <div class="file-item">

                    <div class="file-name-area">
                        {% if f.is_dir %}
                            {% set new_path = (current_path + '/' + f.filename) if current_path else f.filename %}
                            <a href="{{ url_for('file.view_share', share_key=share_key) }}?path={{ new_path|urlencode }}{% if password %}&pwd={{ password }}{% endif %}"
                               style="text-decoration: none; color: inherit; display: flex; align-items: center;">
                                <div class="icon {{ f.icon_class }}" title="打开文件夹"></div>
                                <div class="filename" title="{{ f.filename }}">{{ f.filename }}</div>
                            </a>
                        {% else %}
                            <div class="icon {{ f.icon_class|lower }}" title="{{ f.icon_class|upper }} {{ f.filename }}"></div>
                        {% endif %}
                        <div class="filename" title="{{ f.filename }}">{{ f.filename }}</div>
                    </div>

                    <div>
                        {% if f.is_dir %}-{% else %}{{ f.filesize | format_file_size }}{% endif %}
                    </div>
                    <div>{{ f.create_datetime[:19].replace('T', ' ') }}</div>
                    <div class="actions">
                        {% if not f.is_dir and share.allow_download %}
                            <a class="btn" href="{{ url_for('file.download_file', file_id=f.id) }}">下载</a>
                        {% endif %}
                        <!-- 不显示删除按钮 -->
                    </div>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p>此分享内容为空。</p>
    {% endif %}
</div>
</body>
</html>